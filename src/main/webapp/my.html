<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>coverme</title>
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <link rel="stylesheet" type="text/css" href="styles/search_results.css" />
    <link rel="stylesheet" href="styles/header.css">
    <link id="style" rel="stylesheet" href="styles/style.css">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>
    <script
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCOMxTQ8uWeUUxYOaciOHRwEsaWCA0eQeQ&callback=initMy&libraries=&v=weekly"
      defer
    ></script>
    <script src="scripts/script.js"></script>
    <script src="scripts/search_results.js"></script>
  </head>
  <body onload="checkLogin()">
    <!-- header -->
    <div id="header">
        <div id="logo" onclick="window.location.href='index.html';"><div>coverme♥️</div></div>
        <div id="search-bar">
            <input type="text" class="search-bar left" id="job_type" placeholder="find a job to cover...">
            <input type="text" class="search-bar right" id="location" placeholder="Location">
            <img onclick="submit()" class="search-button" src="images/search.png"/>
        </div>
        <div id="user-info">
            <div>Loading...</div>
        </div>
    </div>

    <div class="main-row">
        <div id="postings" class="main-column"></div>
        <div id="no-posts"></div>
        <div id="map" class="main-column"></div>
    </div>


</body>

<script>

    document.getElementById('search-bar').onkeypress = function(e){
        if (!e) e = window.event;
        var keyCode = e.keyCode || e.which;
        if (keyCode == '13'){
            submit();
        }
    }

    function submit() {
        let url = '/search';
        url += '?job=' + encodeURIComponent(document.getElementById('job_type').value);
        // need to fix by calling maps api
        url += '&location=' + document.getElementById('location').value;

        fetch(url).then((response) => response.json())
        .then(function(responseJson) {
            // do something with json output of html response
        });
    }
</script>

</html>